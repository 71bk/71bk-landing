# 71BK Portfolio Platform 使用者故事 (User Stories)
> 根據架構書 v3.0 與 mysql_schema_v2.sql 產出  
> 最後更新：2025-12-23

---

## 角色定義 (Personas)

| 角色 | 說明 |
|------|------|
| 👤 **訪客 (Visitor)** | 瀏覽作品集的外部使用者（HR、技術主管、同事） |
| 👨‍💼 **管理者 (Admin)** | 網站擁有者（71BK 本人），管理內容與查看數據 |
| 🤖 **LINE 用戶** | 透過 LINE Bot 互動的使用者 |

---

## Epic 1：Public Portfolio（公開作品集）

### 1.1 首頁與導覽

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-1.1.1 | 身為**訪客**，我想要看到一個專業的首頁，以便快速了解網站主人的專業能力 | Hero 區域顯示個人介紹、精選作品展示在首頁 |
| US-1.1.2 | 身為**訪客**，我想要有清楚的導覽列，以便快速找到我想看的內容 | 導覽列包含：Home、Projects、About、Contact |

### 1.2 作品列表與篩選

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-1.2.1 | 身為**訪客**，我想要瀏覽所有已發布的作品，以便了解網站主人的作品集 | 只顯示 `status=PUBLISHED` 的作品 |
| US-1.2.2 | 身為**訪客**，我想要依技術標籤篩選作品，以便找到特定技術的專案 | 可選擇 tech tag（如 Vue、Spring Boot）進行篩選 |
| US-1.2.3 | 身為**訪客**，我想要依作品類型篩選，以便找到特定類型的專案 | 可依 category（SYSTEM/FRONTEND/BACKEND/TOOL）篩選 |
| US-1.2.4 | 身為**訪客**，我想要看到精選作品標記，以便快速找到重點作品 | `featured=true` 的作品有特殊標記或優先顯示 |
| US-1.2.5 | 身為**訪客**，我想要使用關鍵字搜尋作品，以便快速找到相關專案 | 搜尋功能對 `search_text` 欄位進行 FULLTEXT 搜尋 |

### 1.3 作品詳情

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-1.3.1 | 身為**訪客**，我想要查看作品的完整 Case Study，以便了解專案的技術細節 | 顯示 Problem/Solution/Architecture/Stack 等內容 |
| US-1.3.2 | 身為**訪客**，我想要點擊外部連結（Demo/GitHub），以便實際體驗或查看原始碼 | 每個作品顯示 `project_links` 中的連結按鈕 |
| US-1.3.3 | 身為**訪客**，我想要看到作品使用的技術標籤，以便快速了解技術棧 | 顯示該作品關聯的所有 `portfolio_techs` |

### 1.4 AI 搜尋助手

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-1.4.1 | 身為**訪客**，我想要透過聊天介面詢問問題，以便找到符合需求的作品 | 右下角浮動按鈕開啟 Chat Drawer |
| US-1.4.2 | 身為**訪客**，我想要 AI 回傳相關作品卡片，而非純文字回答 | 回傳 Top 3-5 作品卡片，含標題、摘要、連結 |
| US-1.4.3 | 身為**訪客**，我想要知道為什麼 AI 推薦這些作品，以便判斷相關性 | 每個結果附 `matchReason` 說明 |
| US-1.4.4 | 身為**訪客**，我想要看到建議的篩選條件，以便進一步縮小範圍 | 回傳 `suggestedFilters`（tech/category） |

---

## Epic 2：Admin Platform（管理後台）

### 2.1 登入與認證

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-2.1.1 | 身為**管理者**，我想要透過 LINE Login 登入後台，以便安全地管理內容 | 使用 LINE OAuth 2.0 流程，成功後建立 session |
| US-2.1.2 | 身為**管理者**，我想要登入狀態持續一段時間，以便不用頻繁重新登入 | 使用 HttpOnly Refresh Cookie + 短效 Access Token |
| US-2.1.3 | 身為**管理者**，我想要只有我能存取後台，以便確保資料安全 | 只有 `admin_users` 表中的使用者可登入 |

### 2.2 作品管理 (CRUD)

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-2.2.1 | 身為**管理者**，我想要新增作品，以便豐富我的作品集 | 可填寫 title、slug、summary、content_md、cover 等欄位 |
| US-2.2.2 | 身為**管理者**，我想要編輯現有作品，以便修正錯誤或更新內容 | 可修改所有作品欄位並儲存 |
| US-2.2.3 | 身為**管理者**，我想要刪除或封存作品，以便移除不再展示的內容 | 可將 status 改為 ARCHIVED 或直接刪除 |
| US-2.2.4 | 身為**管理者**，我想要設定作品狀態（草稿/發布/封存），以便控制何時公開 | status 可切換：DRAFT → PUBLISHED → ARCHIVED |
| US-2.2.5 | 身為**管理者**，我想要標記精選作品，以便讓重點專案優先顯示 | 可切換 `featured` 欄位 |
| US-2.2.6 | 身為**管理者**，我想要調整作品排序，以便控制顯示順序 | 可修改 `sort_order` 或拖曳排序 |
| US-2.2.7 | 身為**管理者**，我想要為作品設定分類與評分，以便支援 AI 搜尋 | 可設定 category、difficulty_score、impact_score |

### 2.3 外部連結管理

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-2.3.1 | 身為**管理者**，我想要為作品新增外部連結，以便展示 Demo/GitHub/文件 | 可新增 link（type、url、label） |
| US-2.3.2 | 身為**管理者**，我想要管理連結類型，以便區分不同資源 | 支援 DEMO/GITHUB/DOC/BLOG/OTHER |
| US-2.3.3 | 身為**管理者**，我想要調整連結順序，以便控制顯示優先級 | 可修改 `sort_order` |

### 2.4 技術標籤管理

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-2.4.1 | 身為**管理者**，我想要為作品指定技術標籤，以便支援篩選功能 | 可從 `portfolio_techs` 選擇多個標籤 |
| US-2.4.2 | 身為**管理者**，我想要新增技術標籤，以便加入新的技術 | 可新增 tech（如 Docker、Kubernetes） |

---

## Epic 3：LINE Bot 整合

### 3.1 Webhook 接收

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-3.1.1 | 身為**系統**，我想要接收 LINE Webhook 事件，以便記錄用戶訊息 | 正確驗證 X-Line-Signature |
| US-3.1.2 | 身為**系統**，我想要避免重複處理相同事件，以便確保資料一致性 | 使用 `event_id` 做冪等性檢查 |
| US-3.1.3 | 身為**系統**，我想要記錄所有 INBOUND 訊息，以便後台查詢 | 寫入 `line_message_logs`（direction=INBOUND） |

### 3.2 訊息管理（後台）

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-3.2.1 | 身為**管理者**，我想要查看所有 LINE 用戶列表，以便了解互動對象 | 顯示 `line_users` 列表 |
| US-3.2.2 | 身為**管理者**，我想要查看特定用戶的訊息歷史，以便追蹤互動紀錄 | 依 `line_user_id` 篩選 `line_message_logs` |
| US-3.2.3 | 身為**管理者**，我想要看到訊息的原始 payload，以便除錯 | 顯示 `payload_json` 欄位內容 |

### 3.3 推播功能（後台）

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-3.3.1 | 身為**管理者**，我想要選擇用戶發送推播訊息，以便主動通知 | 可選擇 `line_users` 中的用戶發送訊息 |
| US-3.3.2 | 身為**管理者**，我想要記錄推播結果，以便追蹤發送狀態 | 寫入 `line_message_logs`（direction=OUTBOUND, status=SENT/FAILED） |

---

## Epic 4：Analytics（數據統計）

### 4.1 事件追蹤（前端上報）

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-4.1.1 | 身為**系統**，我想要記錄頁面瀏覽事件，以便統計 PV | 首頁/作品列表觸發 `PAGE_VIEW` 事件 |
| US-4.1.2 | 身為**系統**，我想要記錄作品詳情瀏覽，以便統計作品熱度 | 進入作品詳情頁觸發 `PROJECT_VIEW` 事件 |
| US-4.1.3 | 身為**系統**，我想要記錄外部連結點擊，以便統計連結效果 | 點擊 Demo/GitHub 觸發 `LINK_CLICK` 事件 |
| US-4.1.4 | 身為**系統**，我想要記錄搜尋行為，以便分析訪客需求 | 使用搜尋功能觸發 `SEARCH` 事件（含 query） |
| US-4.1.5 | 身為**系統**，我想要記錄 AI 聊天查詢，以便分析常見問題 | 使用 Chat 觸發 `CHAT_QUERY` 事件（含 query） |

### 4.2 統計儀表板（後台）

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-4.2.1 | 身為**管理者**，我想要看到總覽數據卡片，以便快速了解網站表現 | 顯示：總 PV、總點擊數、作品數、發布數 |
| US-4.2.2 | 身為**管理者**，我想要看到熱門作品排行，以便了解哪些作品最受歡迎 | 依 `PROJECT_VIEW` 數量排序的 Top N 作品 |
| US-4.2.3 | 身為**管理者**，我想要看到熱門連結排行，以便了解訪客行為 | 依 `LINK_CLICK` 數量排序的 Top N 連結 |
| US-4.2.4 | 身為**管理者**，我想要選擇時間範圍查看數據，以便分析趨勢 | 可選擇：7 天 / 30 天 / 全部 |
| US-4.2.5 | 身為**管理者**，我想要查看單一作品的詳細統計，以便深入分析 | 顯示該作品的 views、link clicks over time |

---

## Epic 5：系統與安全

### 5.1 API 安全

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-5.1.1 | 身為**系統**，我想要驗證 Admin API 請求必須帶有效 JWT，以便確保只有管理者可存取 | 未帶 token 或 token 過期回傳 401 |
| US-5.1.2 | 身為**系統**，我想要限制 CORS 只允許特定來源，以便防止跨站攻擊 | 只允許 `71bk.dev` 和 `profile.71bk.dev` |
| US-5.1.3 | 身為**系統**，我想要對 Webhook 做簽章驗證，以便確保請求來自 LINE | 驗證 X-Line-Signature 才處理 |

### 5.2 錯誤處理

| ID | 使用者故事 | 驗收條件 |
|----|-----------|---------|
| US-5.2.1 | 身為**開發者**，我想要 API 回傳統一的錯誤格式，以便前端統一處理 | 回傳 `{ code, message, data }` 格式 |
| US-5.2.2 | 身為**訪客**，我想要看到友善的錯誤頁面，以便知道發生什麼問題 | 404/500 等錯誤有對應的頁面 |

---

## 優先級建議 (Roadmap Mapping)

| 階段 | 包含 Epic | 優先級 |
|------|----------|--------|
| **M1** | US-1.1.x, US-1.2.x, US-1.3.x（mock data） | 🔴 最高 |
| **M2** | US-1.2.x, US-1.3.x（接 API） | 🔴 最高 |
| **M3** | US-2.1.x, US-2.2.x, US-2.3.x, US-2.4.x | 🟠 高 |
| **M4** | US-3.1.x, US-3.2.x, US-3.3.x | 🟡 中 |
| **M5** | US-4.1.x, US-4.2.x | 🟡 中 |
| **M6** | US-1.4.x | 🟢 低（差異化賣點） |
