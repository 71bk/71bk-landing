# 71BK Portfolio Platform æ•´åˆæž¶æ§‹æ›¸ v3.0ï¼ˆMySQL / Admin + Public + LINE Bot + Analytics + AIï¼‰
ä½œè€…ï¼š71BK  
æœ€å¾Œæ›´æ–°ï¼š2025-12-23

**Public Portfolioï¼ˆå±•ç¤ºç«™ï¼‰**ï¼š`https://71bk.dev`ï¼ˆæˆ– `https://www.71bk.dev`ï¼‰  
**Admin Platformï¼ˆç®¡ç†å¾Œå°ï¼‰**ï¼š`https://profile.71bk.dev`  
**Backend API**ï¼š`https://api-profile.71bk.dev`  
**éƒ¨ç½²æ–¹æ¡ˆ**ï¼šCloudflare Pagesï¼ˆPublic/Adminï¼‰ + AWS EC2ï¼ˆNginx â†’ Spring Bootï¼‰ + MySQL 8

> **æœ¬æ–‡ä»¶ç›®æ¨™**ï¼šæ•´åˆã€Œå€‹äººä½œå“é›† CMSã€+ã€ŒLINE Bot è¨Šæ¯ç®¡ç†ã€+ã€Œæ•¸æ“šçµ±è¨ˆã€+ã€ŒAI å°ˆæ¡ˆæœå°‹ã€çš„å®Œæ•´ç³»çµ±æž¶æ§‹ã€‚  
> **æ ¸å¿ƒç†å¿µ**ï¼šå…ˆæœ‰æ±è¥¿èƒ½å±•ç¤ºï¼ˆPublic ç«™å…ˆä¸Šç·šï¼‰ï¼Œå¾ŒçºŒé€æ­¥è£œé½Šå¾Œå°ã€çµ±è¨ˆèˆ‡ AIã€‚

---

## 1. å°ˆæ¡ˆå®šä½èˆ‡ç›®æ¨™

### 1.1 ä½ åœ¨åšçš„ä¸æ˜¯ã€Œéœæ…‹ä½œå“é›†ã€
ä½ åœ¨åšçš„æ˜¯ä¸€å€‹ **Portfolio CMSï¼ˆå¯ç™»å…¥ã€å¯ç®¡ç†ã€å¯ä¸Šæž¶å…§å®¹ï¼‰**ï¼Œä¸¦æ•´åˆå¤šé …ç³»çµ±èƒ½åŠ›ï¼š

| æ¨¡çµ„ | åŠŸèƒ½ | å°è±¡ |
|------|------|------|
| **Admin Console** | ç®¡ç†ä½œå“ã€å°é¢ã€æŽ’åºã€ç²¾é¸ã€LINE ç”¨æˆ¶èˆ‡è¨Šæ¯ã€æŽ¨æ’­ã€æ•¸æ“šçµ±è¨ˆ | ä½ è‡ªå·± |
| **Public Portfolio** | å…¬é–‹å±•ç¤ºå·²ä¸Šæž¶ä½œå“ï¼ˆSEO/åˆ†äº«/ç€è¦½é«”é©—ï¼‰+ AI æœå°‹åŠ©æ‰‹ | è¨ªå®¢ |
| **LINE Bot** | æŽ¥ webhookã€è¨˜éŒ„è¨Šæ¯ã€å›žè¦†èˆ‡æŽ¨æ’­ | LINE ç”¨æˆ¶ |

---

### 1.2 Public Portfolioï¼ˆçµ¦å…¶ä»–äººçœ‹ï¼‰
**æ ¸å¿ƒèƒ½åŠ›**
- å±•ç¤ºä½œå“ï¼šåˆ—è¡¨ / è©³æƒ…é ï¼ˆCase Studyï¼‰
- æ¯å€‹ä½œå“å…·å‚™ã€Œå¤–éƒ¨é€£çµã€ï¼šDemo / GitHub / Docs / Blog / å­ç¶²åŸŸ
- æœå°‹ / ç¯©é¸ï¼šä¾æŠ€è¡“ï¼ˆtechï¼‰ã€é¡žåž‹ï¼ˆcategoryï¼‰ã€ç²¾é¸ï¼ˆfeaturedï¼‰

**è¨ªå®¢äº’å‹•**
- é»žæ“Šä½œå“ï¼ˆå¯çµ±è¨ˆï¼‰
- é»žæ“Šå¤–éƒ¨é€£çµï¼ˆå¯çµ±è¨ˆï¼‰
- ä½¿ç”¨ AI æœå°‹ï¼ˆå¯çµ±è¨ˆï¼‰

---

### 1.3 Admin Platformï¼ˆä½ è‡ªå·±ç®¡ç†ï¼‰
**å…§å®¹ç®¡ç†ï¼ˆCMSï¼‰**
- ä½œå“ CRUDï¼šæ¨™é¡Œã€æ‘˜è¦ã€å°é¢ã€å…§å®¹ã€ç‹€æ…‹ï¼ˆdraft/published/archivedï¼‰
- ä½œå“æŽ’åºï¼šsort_order / featured
- å¤–éƒ¨é€£çµç®¡ç†ï¼šdemo/github/docs/blog

**LINE è¨Šæ¯ç®¡ç†**
- LINE Users åˆ—è¡¨
- Messages æŒ‰ user æŸ¥è©¢ message_logs
- Push é¸ user æŽ¨æ’­è¨Šæ¯

**æ•¸æ“šçµ±è¨ˆï¼ˆAnalytics Dashboardï¼‰**
- ä½œå“ç€è¦½æ•¸ï¼ˆproject viewï¼‰
- å¤–éƒ¨é€£çµé»žæ“Šï¼ˆlink clickï¼‰
- ç†±é–€ä½œå“æŽ’è¡Œ
- ç†±é–€æœå°‹å­— / ç†±é–€èŠå¤©å•é¡Œï¼ˆå¯é¸ï¼‰

---

### 1.4 AI æœå°‹åŠ©æ‰‹ï¼ˆPublic ç«™çš„ chatï¼‰
**ç›®æ¨™**
- ä¸æ˜¯ã€ŒèŠå¤©è€Œå·²ã€ï¼Œæ˜¯ã€Œå¹«è¨ªå®¢æ‰¾ä½œå“ã€
- ä½¿ç”¨ä½ é‡åŒ–å¾Œçš„è³‡æ–™ï¼ˆtech/category/scoresï¼‰+ ä½œå“å…§å®¹ï¼ˆcase study textï¼‰ä¾†æª¢ç´¢èˆ‡æŽ’åº

**è¼¸å‡ºå½¢å¼ï¼ˆå¿…é ˆç”¢å“åŒ–ï¼‰**
- å›žå‚³ Top N ä½œå“å¡ç‰‡ï¼ˆå« linksï¼‰
- æ¯å€‹çµæžœé™„ã€Œç‚ºä»€éº¼æŽ¨è–¦ã€ï¼ˆmatch reasonï¼‰
- æä¾›å¯é»žé¸çš„å¿«é€Ÿç¯©é¸å»ºè­°ï¼ˆsuggested filtersï¼‰

---

## 2. æŠ€è¡“å †ç–Š

### 2.1 Frontend
- **æ¡†æž¶**ï¼šVue 3 (Composition API) + Vite
- **ç‹€æ…‹ç®¡ç†**ï¼šPinia
- **è·¯ç”±**ï¼šVue Router
- **UI**ï¼šTailwind CSSï¼ˆå¯æ­é… Element Plus / Headless UIï¼‰
- **éƒ¨ç½²**ï¼šCloudflare Pagesï¼ˆProduction/Previewï¼‰

### 2.2 Backend
- **æ¡†æž¶**ï¼šSpring Boot 3 + Spring Security
- **èªè­‰**ï¼šLINE Login + JWTï¼ˆAdmin APIï¼‰
- **Webhook**ï¼šLINE webhook signature verifyï¼ˆHMAC-SHA256ï¼‰
- **è³‡æ–™åº«**ï¼šMySQL 8

### 2.3 Infra
- **å‰ç«¯éƒ¨ç½²**ï¼šCloudflare Pagesï¼ˆAdmin Console / Public Siteï¼‰
- **å¾Œç«¯éƒ¨ç½²**ï¼šAWS EC2ï¼ˆNginx Reverse Proxy â†’ Spring Bootï¼‰
- **DNS / TLS**ï¼šCloudflare ç®¡ç†

---

## 3. ç³»çµ±é«˜å±¤æž¶æ§‹

```mermaid
flowchart LR
  U[User Browser] -->|HTTPS| PUB[Cloudflare Pages<br/>Public: 71bk.dev]
  U -->|HTTPS| ADM[Cloudflare Pages<br/>Admin: profile.71bk.dev]
  PUB -->|HTTPS| API[api-profile.71bk.dev]
  ADM -->|HTTPS| API
  API --> NX[Nginx on EC2]
  NX --> SB[Spring Boot API]
  SB --> DB[(MySQL 8)]
  
  LINE[LINE Platform] -->|Webhook| API
  API -->|Reply/Push| LINE
```

---

## 4. ç¶²åŸŸèˆ‡å‰ç«¯åˆ‡åˆ†ç­–ç•¥

### 4.1 Domain Splitï¼ˆæ¸…æ¥šã€å¥½ç¶­è­·ï¼‰
| ç¶²åŸŸ | ç”¨é€” | èªè­‰ |
|------|------|------|
| `71bk.dev` | Public Portfolioï¼ˆå…¬é–‹ç«™ï¼‰ | ç„¡ |
| `profile.71bk.dev` | Admin Consoleï¼ˆéœ€è¦ LINE Loginï¼‰ | JWT |
| `api-profile.71bk.dev` | Backend APIï¼ˆEC2 ä¸Šï¼‰ | ä¾ Endpoint |

é€™æ¨£çš„åˆ‡åˆ†å¯ä»¥è®“ä½ çš„ä½œå“é›†ã€Œä¸€çœ¼åƒç”¢å“ã€ï¼Œä¹Ÿæ–¹ä¾¿åš RBAC èˆ‡ CORSã€‚

### 4.2 å‰ç«¯å°ˆæ¡ˆçµæ§‹ï¼ˆæŽ¨è–¦ï¼šMonorepo å…©å€‹ Appï¼‰
> å…©å€‹å‰ç«¯åˆ†é›¢ï¼Œç¶­è­·èˆ‡å®‰å…¨éƒ½æ›´ä¹¾æ·¨ï¼›ä½ è¦å±•ç¤ºä¹Ÿæ›´æ¸…æ¥šã€‚

```
portfolio-system/
  apps/
    admin-console/          # profile.71bk.dev
    public-portfolio/       # 71bk.dev
  packages/
    ui/                     # å…±ç”¨ UI components (optional)
    api-client/             # å…±ç”¨ API client / types (optional)
  docs/
    architecture/
  pnpm-workspace.yaml (or npm workspaces)
```

---

## 5. æ ¸å¿ƒæµç¨‹

### 5.1 Admin Loginï¼ˆLINE Login â†’ å–å¾—å¾Œå° sessionï¼‰
> é€™æ®µè¦å¯«å¾—ã€Œå®‰å…¨ã€å¯å±•ç¤ºã€ï¼Œé¿å… redirect å¸¶ token çš„ç–‘æ…®ã€‚

**æŽ¨è–¦æ–¹æ¡ˆï¼šHttpOnly Refresh Cookie**
1. Admin Console å‘¼å«ï¼š`GET /api/auth/line/login-url`
2. è½‰å°Žåˆ° LINE æŽˆæ¬Šé 
3. LINE callback åˆ°å¾Œç«¯ï¼š`GET /api/auth/line/callback?code=...`
4. å¾Œç«¯å®Œæˆï¼š
   - äº¤æ› LINE token / å–å¾— profile
   - å»ºç«‹/æ›´æ–° `admin_users`
   - **Set-Cookie: refresh_tokenï¼ˆHttpOnly, Secure, SameSiteï¼‰**
   - redirect å›žå‰ç«¯ `/oauth-callback`
5. å‰ç«¯é€²å…¥ callback é å¾Œå‘¼å«ï¼š`GET /api/auth/me`
6. å‰ç«¯å–å¾— user è³‡è¨Šèˆ‡çŸ­æ•ˆ access tokenï¼ˆç”¨æ–¼å¾ŒçºŒ `Authorization: Bearer`ï¼‰

> å±•ç¤ºé‡é»žï¼šä½ ç†è§£ **cookie SameSiteã€è·¨ç¶²åŸŸã€redirect å®‰å…¨æ€§**ã€‚

---

### 5.2 LINE Webhookï¼ˆä¸èµ° JWTï¼Œèµ°ç°½ç« é©—è­‰ï¼‰
1. LINE å¹³å° POSTï¼š`/api/line/webhook`
2. å¾Œç«¯é©—è­‰ï¼š`X-Line-Signature`ï¼ˆHMAC-SHA256ï¼‰
3. è§£æž eventï¼Œå¯«å…¥ `line_message_logs (INBOUND)`
4. è¦–éœ€æ±‚å›žè¦†æˆ–æŽ¨æ’­ï¼Œä¸¦å¯«å…¥ `line_message_logs (OUTBOUND)`

âœ… **Webhook å¿…åšï¼šå†ªç­‰æ€§ï¼ˆIdempotencyï¼‰**
- æ¯å€‹ event å–å¾—å¯å”¯ä¸€è­˜åˆ¥ï¼ˆä¾‹å¦‚ LINE eventIdï¼Œæˆ–ç”¨ payload çµ„åˆ hashï¼‰
- DB å…ˆæŸ¥ `event_id` æ˜¯å¦å·²è™•ç†ï¼Œå·²å­˜åœ¨å‰‡ç›´æŽ¥å¿½ç•¥

---

### 5.3 Admin Pushï¼ˆå¾Œå°ä¸»å‹•æŽ¨æ’­ï¼‰
1. Admin Console å‘¼å«ï¼š`POST /api/admin/line/push`
2. å¾Œç«¯é©— JWT + RBACï¼ˆåƒ… adminï¼‰
3. æª¢æŸ¥ç›®æ¨™ `line_users` å­˜åœ¨
4. å‘¼å« LINE Push API
5. å¯«å…¥ `line_message_logs (OUTBOUND)` + ç‹€æ…‹ï¼ˆSENT/FAILEDï¼‰

---

### 5.4 Analytics äº‹ä»¶ä¸Šå ±ï¼ˆå‰ç«¯åšï¼‰
Public ç«™åœ¨é€™äº›æ™‚æ©Ÿå‘¼å« `POST /api/public/analytics/event`ï¼š
- é€²é¦–é ï¼ˆPAGE_VIEWï¼‰
- é€²ä½œå“è©³æƒ…ï¼ˆPROJECT_VIEWï¼‰
- é»ž demo/githubï¼ˆLINK_CLICKï¼‰
- ä½¿ç”¨ç«™å…§æœå°‹ï¼ˆSEARCHï¼‰
- ä½¿ç”¨ chatï¼ˆCHAT_QUERYï¼‰

---

## 6. åŠŸèƒ½æž¶æ§‹ï¼ˆç”¢å“è¦–è§’ï¼‰

### 6.1 Public Portfolio Pagesï¼ˆIA å»ºè­°ï¼‰
- **Home**ï¼ˆHero + ç²¾é¸ä½œå“ï¼‰
- **Projects**ï¼ˆåˆ—è¡¨ + ç¯©é¸/æœå°‹ï¼‰
- **Project Detail**ï¼ˆcase studyï¼šProblem/Solution/Architecture/Stack/Linksï¼‰
- **About**ï¼ˆskills/stackï¼‰
- **Contact**ï¼ˆlinksï¼‰
- **Chatbot**ï¼ˆæµ®å‹•æŒ‰éˆ• / drawerï¼‰

### 6.2 Admin Platform Pagesï¼ˆIA å»ºè­°ï¼‰
- **Dashboard**ï¼ˆçµ±è¨ˆå¡ç‰‡ï¼šä½œå“æ•¸ã€publishedã€è¨Šæ¯é‡ã€top projectsï¼‰
- **Portfolio**
  - Projects Listï¼ˆç‹€æ…‹ã€featuredã€æŽ’åºï¼‰
  - Project Editorï¼ˆå…§å®¹ã€å°é¢ã€ç‹€æ…‹ï¼‰
  - Links Editorï¼ˆdemo/github/etcï¼‰
- **LINE**
  - Usersï¼ˆline_users åˆ—è¡¨ï¼‰
  - Messagesï¼ˆæŒ‰ user æŸ¥è©¢ message_logsï¼‰
  - Pushï¼ˆé¸ user æŽ¨æ’­è¨Šæ¯ï¼‰
- **Analytics**
  - Overviewï¼ˆPVã€clicksã€topï¼‰
  - Project Detail Analyticsï¼ˆå–®ä¸€ä½œå“ï¼‰
  - Queriesï¼ˆsearch/chat topï¼‰*å¯é¸
- **Settings**ï¼ˆå¯é¸ï¼šwebhook healthã€env é¡¯ç¤ºï¼‰

---

## 7. API è¨­è¨ˆ

### 7.1 Endpoints ç¸½è¦½
| åˆ†é¡ž | Method | Path | Auth | èªªæ˜Ž |
|------|--------|------|------|------|
| Auth | GET | /api/auth/line/login-url | Public | å–å¾— LINE æŽˆæ¬Šé€£çµ |
| Auth | GET | /api/auth/line/callback | Public | LINE callbackï¼ˆå¾Œç«¯ï¼‰ |
| Auth | GET | /api/auth/me | Cookie/Token | å–å¾—ç™»å…¥è€…è³‡è¨Š |
| Auth | POST | /api/auth/refresh | Cookie | æ›æ–° access token |
| LINE | POST | /api/line/webhook | Signature | LINE Webhookï¼ˆé©—ç°½ç« ï¼‰ |
| LINE(Admin) | POST | /api/admin/line/push | JWT | å¾Œå°æŽ¨æ’­ |
| Portfolio(Admin) | CRUD | /api/admin/portfolio/projects | JWT | å¾Œå°ç®¡ç†ä½œå“ |
| Portfolio(Admin) | CRUD | /api/admin/portfolio/projects/{id}/links | JWT | ç®¡ç†ä½œå“é€£çµ |
| Portfolio(Public) | GET | /api/public/portfolio/projects | Public | å…¬é–‹ä½œå“åˆ—è¡¨ |
| Portfolio(Public) | GET | /api/public/portfolio/projects/{slug} | Public | å…¬é–‹ä½œå“è©³æƒ… |
| Analytics | POST | /api/public/analytics/event | Public | ä¸Šå ±äº‹ä»¶ |
| Analytics(Admin) | GET | /api/admin/analytics/overview | JWT | çµ±è¨ˆç¸½è¦½ |
| Analytics(Admin) | GET | /api/admin/analytics/projects/top | JWT | ç†±é–€ä½œå“ |
| Chat | POST | /api/public/chat/query | Public | AI æœå°‹ |

### 7.2 éŒ¯èª¤å›žå‚³æ ¼å¼ï¼ˆå»ºè­°ï¼‰
```json
{
  "code": "ERROR_CODE",
  "message": "Human readable message",
  "data": null
}
```

---

## 8. è³‡æ–™åº«è¨­è¨ˆï¼ˆMySQL 8ï¼‰

> æ ¸å¿ƒç†å¿µï¼šWebhook/Push é€™é¡žæ•´åˆç³»çµ±ï¼Œ**è¨˜éŒ„èˆ‡è¿½è¹¤**éžå¸¸é‡è¦ï¼ˆæ‰èƒ½ debugã€æ‰èƒ½å±•ç¤ºï¼‰ã€‚

### 8.1 admin_usersï¼ˆå¾Œå°ç®¡ç†è€…ï¼‰
| æ¬„ä½ | é¡žåž‹ | èªªæ˜Ž |
|------|------|------|
| id | PK | |
| line_user_id | VARCHAR(50) UNIQUE | LINE User ID |
| display_name | VARCHAR(100) | |
| picture_url | VARCHAR(500) | |
| role | ENUM('ADMIN') | |
| created_at / updated_at | DATETIME | |

### 8.2 line_usersï¼ˆLINE ç”¨æˆ¶ï¼‰
| æ¬„ä½ | é¡žåž‹ | èªªæ˜Ž |
|------|------|------|
| id | PK | |
| line_user_id | VARCHAR(50) UNIQUE | |
| display_name | VARCHAR(100) | |
| picture_url | VARCHAR(500) | |
| last_seen_at | DATETIME | |
| created_at / updated_at | DATETIME | |

### 8.3 line_message_logsï¼ˆè¨Šæ¯ç´€éŒ„ï¼šINBOUND / OUTBOUNDï¼‰
| æ¬„ä½ | é¡žåž‹ | èªªæ˜Ž |
|------|------|------|
| id | PK | |
| event_id | VARCHAR(100) UNIQUE | âœ… ç”¨æ–¼å†ªç­‰æ€§ |
| direction | ENUM('INBOUND','OUTBOUND') | |
| line_user_id | VARCHAR(50) INDEX | |
| message_type | VARCHAR(20) | text/image/etc |
| message_text | TEXT | |
| payload_json | JSON | âœ… ä¿ç•™åŽŸå§‹ payload |
| status | ENUM('SENT','FAILED','RECEIVED') | |
| line_api_response | JSON | |
| created_at | DATETIME | |

### 8.4 portfolio_projectsï¼ˆä½œå“ï¼‰
| æ¬„ä½ | é¡žåž‹ | èªªæ˜Ž |
|------|------|------|
| id | PK | |
| title | VARCHAR(200) | |
| slug | VARCHAR(100) UNIQUE | âœ… å…¬é–‹ç¶²å€ç”¨ |
| summary | TEXT | |
| content_md | LONGTEXT | |
| cover_image_url | VARCHAR(500) | |
| status | ENUM('DRAFT','PUBLISHED','ARCHIVED') | |
| featured | BOOLEAN | |
| sort_order | INT | |
| category | ENUM('SYSTEM','FRONTEND','BACKEND','TOOL') | AI/æœå°‹ç”¨ |
| difficulty_score | TINYINT | 1â€“5 |
| impact_score | TINYINT | 1â€“5 |
| search_text | LONGTEXT | èšåˆ title+summary+content+tech |
| published_at | DATETIME | |
| created_at / updated_at | DATETIME | |

### 8.5 project_linksï¼ˆä½œå“å¤–éƒ¨é€£çµï¼‰
| æ¬„ä½ | é¡žåž‹ | èªªæ˜Ž |
|------|------|------|
| id | PK | |
| project_id | FK | |
| type | ENUM('DEMO','GITHUB','DOC','BLOG','OTHER') | |
| url | VARCHAR(500) | |
| label | VARCHAR(100) | é¡¯ç¤ºæ–‡å­— |
| sort_order | INT | |

### 8.6 portfolio_techs / portfolio_project_techsï¼ˆæŠ€è¡“æ¨™ç±¤ï¼‰
**portfolio_techs**
| æ¬„ä½ | é¡žåž‹ | èªªæ˜Ž |
|------|------|------|
| id | PK | |
| name | VARCHAR(50) UNIQUE | |

**portfolio_project_techsï¼ˆmany-to-manyï¼‰**
| æ¬„ä½ | é¡žåž‹ | èªªæ˜Ž |
|------|------|------|
| project_id | FK | |
| tech_id | FK | |
| UNIQUE(project_id, tech_id) | | |

### 8.7 analytics_eventsï¼ˆäº‹ä»¶è¿½è¹¤ï¼‰
| æ¬„ä½ | é¡žåž‹ | èªªæ˜Ž |
|------|------|------|
| id | PK | |
| event_type | ENUM | PAGE_VIEW/PROJECT_VIEW/LINK_CLICK/SEARCH/CHAT_QUERY |
| project_id | FK nullable | |
| link_id | FK nullable | |
| path | VARCHAR(500) | ç•¶ä¸‹é é¢ |
| referrer | VARCHAR(500) | |
| session_id | VARCHAR(100) | åŒ¿åå³å¯ |
| meta_json | JSON | å¯æ”¾ query text / filters |
| created_at | DATETIME | |

---

## 9. CORS / Cookie / Security

### 9.1 CORSï¼ˆè·¨ç¶²åŸŸï¼šPages â†” APIï¼‰
- `profile.71bk.dev` / `71bk.dev` å‘¼å« `api-profile.71bk.dev`
- å¾Œç«¯éœ€å…è¨±ç‰¹å®š originï¼ˆ**ä¸è¦ç”¨ `*`**ï¼‰
- è‹¥ä½¿ç”¨ cookieï¼ˆrefresh_tokenï¼‰ï¼š
  - `Access-Control-Allow-Credentials: true`
  - å‰ç«¯ axios/fetch éœ€è¦ `withCredentials: true`

### 9.2 Cookie å»ºè­°ï¼ˆè‹¥ç”¨ refresh cookieï¼‰
- HttpOnly: âœ…
- Secure: âœ…ï¼ˆHTTPSï¼‰
- SameSite: `None`ï¼ˆè·¨ç¶²åŸŸéœ€é…åˆ Secureï¼‰

### 9.3 Webhook å®‰å…¨
- webhook endpoint ä¸éœ€è¦ JWT
- **åªä¿¡ä»»ç°½ç« é©—è­‰**ï¼ˆHMAC-SHA256ï¼‰
- å»ºè­°å° webhook endpoint åš rate limit / basic WAF

### 9.4 Admin å¾Œå°é˜²è­·
- Rate Limitingï¼ˆç™»å…¥å˜—è©¦ã€API è«‹æ±‚ï¼‰
- IP ç™½åå–®ï¼ˆå¯é¸ï¼‰
- JWT çŸ­æ•ˆæœŸ + Refresh Token æ©Ÿåˆ¶

---

## 10. AI æœå°‹åŠ©æ‰‹ï¼ˆv1ï¼šå…ˆåšå¯æŽ§ä¸”å¯å±•ç¤ºï¼‰

### 10.1 è³‡æ–™æº–å‚™ï¼ˆä½ çš„ã€Œé‡åŒ–å¾Œè³‡æ–™ã€è½åœ°ï¼‰
- çµæ§‹åŒ–ï¼štechs, category, scores
- éžçµæ§‹åŒ–ï¼šcontent_md / summary
- èšåˆæ¬„ä½ï¼š`search_text`

### 10.2 æª¢ç´¢ç­–ç•¥ï¼ˆv1 å…ˆç”¨ MySQL FULLTEXTï¼‰
1. Step Aï¼šæŠŠ query æ‹†æˆå¯èƒ½çš„ tech/categoryï¼ˆè¦å‰‡ or mapï¼‰
2. Step Bï¼šç”¨ tech/category å…ˆç¸®å°å€™é¸ï¼ˆçµæ§‹åŒ–ï¼‰
3. Step Cï¼šç”¨ FULLTEXT å° `search_text` åšç›¸é—œåº¦æŽ’åº
4. Step Dï¼šå›žå‚³ Top Nï¼ˆé™„ matchReasonï¼‰

### 10.3 å›žå‚³æ ¼å¼ï¼ˆå»ºè­°ï¼‰
```json
{
  "projects": [
    { "title": "...", "slug": "...", "summary": "...", "techs": [], "links": [], "score": 0.85, "matchReason": "..." }
  ],
  "suggestedFilters": { "tech": [], "category": [] }
}
```

### 10.4 Chat UIï¼ˆPublicï¼‰
- å³ä¸‹è§’æµ®å‹•æŒ‰éˆ• â†’ drawer
- ä¸€æ¬¡å›žå‚³ 3â€“5 å€‹ä½œå“å¡ç‰‡
- æ¯å¼µå¡ç‰‡ 2 å€‹æŒ‰éˆ•ï¼š`Open Detail`ã€`Open Demo/GitHub`

---

## 11. éƒ¨ç½²

### 11.1 Cloudflare Pages
- å…©å€‹ Pages Projectï¼ˆæŽ¨è–¦ï¼‰ï¼š
  - `admin-console` â†’ ç¶ `profile.71bk.dev`
  - `public-portfolio` â†’ ç¶ `71bk.dev`
- ç’°å¢ƒè®Šæ•¸ï¼ˆViteï¼‰ï¼š
  - `VITE_API_BASE_URL=https://api-profile.71bk.dev`

### 11.2 SPA Fallbackï¼ˆé¿å…åˆ·æ–° 404ï¼‰
- Cloudflare Pages è¨­å®š SPA rewriteï¼ˆæ‰€æœ‰éžæª”æ¡ˆè·¯å¾‘ â†’ `/index.html`ï¼‰
- ç¢ºä¿ `_redirects` ä¸æœƒé€ æˆ infinite loop

### 11.3 EC2ï¼ˆNginx â†’ Spring Bootï¼‰
- Nginxï¼š`/api/*` â†’ proxy_pass åˆ° Spring Boot
- Spring Bootï¼š`application-prod.yml` æŒ‡å‘ MySQL
- DBï¼šMySQL 8ï¼ˆå¯èˆ‡å¾Œç«¯åŒæ©Ÿæˆ–ç¨ç«‹ï¼‰

### 11.4 è³‡æ–™å‚™ä»½ï¼ˆå»ºè­°ï¼‰
- MySQL å®šæœŸå‚™ä»½ï¼ˆmysqldump + cronï¼‰
- å‚™ä»½æª”ä¸Šå‚³ S3 æˆ–å…¶ä»–é›²ç«¯å„²å­˜

---

## 12.ã€Œå…ˆæœ‰æ±è¥¿å¯å±•ç¤ºã€çš„åŸ·è¡Œé †åºï¼ˆDemo Roadmapï¼‰
> ä½ æ“”å¿ƒå¾Œé¢åšä¸å®Œæ²’æ±è¥¿å±•ç¤ºï¼Œæ‰€ä»¥ roadmap ä¿è­‰æ¯æ­¥éƒ½æœ‰å¯å±•ç¤ºæˆå“ã€‚

### M1ï¼šPublic Portfolio ä¸Šç·šï¼ˆæœ€å¿« 1 é€±å…§ï¼‰
**åšå®Œå°±èƒ½åˆ†äº«ç¶²å€**
- Public å‰ç«¯ï¼ˆHome/Projects/Project Detailï¼‰
- Projects å…ˆç”¨ mock data ä¹Ÿè¡Œ â†’ å†æŽ¥ public API
- æ¯å€‹ project å…ˆæ”¾ demo/githubï¼ˆå…ˆç¡¬ç·¨ä¹Ÿ OKï¼‰

âœ… **å±•ç¤ºç‰©**ï¼šå…¬é–‹ç«™å¯ç€è¦½ã€ä½œå“è©³æƒ…é  + å¤–éƒ¨é€£çµå°Žå‘

---

### M2ï¼šDatabase + Public APIï¼ˆæ›¿æ› mock dataï¼‰
- MySQL tablesï¼ˆprojects/techs/linksï¼‰
- Public list/detail endpoints

âœ… **å±•ç¤ºç‰©**ï¼šPublic ç«™è³‡æ–™æ”¹ç‚ºå‹•æ…‹ï¼ˆDB ä¾†çš„ï¼‰

---

### M3ï¼šAdmin Platformï¼ˆä½ é–‹å§‹çœŸçš„èƒ½ç®¡ç†ï¼‰
- Admin CRUDï¼ˆä¸Šæž¶/ä¸‹æž¶/å°é¢/æŽ’åºï¼‰
- links ç®¡ç†
- LINE Login æ•´åˆ

âœ… **å±•ç¤ºç‰©**ï¼šå¾Œå°æˆªåœ– + ä¸Šæž¶å¾Œ Public ç«‹å³æ›´æ–°

---

### M4ï¼šLINE Bot æ•´åˆ
- Webhook æŽ¥æ”¶è¨Šæ¯ + å†ªç­‰æ€§
- å¾Œå°æŸ¥çœ‹ LINE ç”¨æˆ¶èˆ‡è¨Šæ¯
- å¾Œå°æŽ¨æ’­åŠŸèƒ½

âœ… **å±•ç¤ºç‰©**ï¼šLINE Bot äº’å‹• demo + å¾Œå°è¨Šæ¯ç®¡ç†æˆªåœ–

---

### M5ï¼šAnalytics v1ï¼ˆç”¢å“æ„Ÿå¤§å¹…ä¸Šå‡ï¼‰
- åªåšå…©å€‹äº‹ä»¶ï¼šPROJECT_VIEW + LINK_CLICKï¼ˆå…ˆæœ€æœ‰åƒ¹å€¼ï¼‰
- å¾Œå° dashboardï¼štotal views / clicks / top projects

âœ… **å±•ç¤ºç‰©**ï¼šDashboard æ•¸æ“šå¡ç‰‡èˆ‡æŽ’è¡Œ

---

### M6ï¼šAI Search v1ï¼ˆä½ çš„å·®ç•°åŒ–è³£é»žï¼‰
- /chat/queryï¼šFULLTEXT + tags filter
- Public chat UIï¼šå›žå‚³ä½œå“å¡ç‰‡ + match reason

âœ… **å±•ç¤ºç‰©**ï¼šChatbot demoï¼šè¼¸å…¥ã€ŒOAuth/JWT/éƒ¨ç½²ã€â†’ æŽ¨è–¦ä½ çš„ä½œå“

---

## 13. ä½œå“é›†å±•ç¤ºå»ºè­°ï¼ˆè®“å®ƒçœ‹èµ·ä¾†åƒã€Œç³»çµ±ã€è€Œéžã€Œé é¢ã€ï¼‰

ä½ åœ¨ä½œå“é›†é é¢ä¸­å¯ä»¥å±•ç¤ºï¼š
- 1 å¼µï¼šSystem diagramï¼ˆCloudflare Pages â†’ API â†’ EC2 â†’ MySQL â†’ LINEï¼‰
- 1 å¼µï¼šWebhook flowï¼ˆå« signature verify + idempotencyï¼‰
- 1 å¼µï¼šAdmin Consoleï¼ˆProjects ç®¡ç†é ï¼‰æˆªåœ–
- 1 å¼µï¼šPublic Portfolioï¼ˆProject detailï¼‰æˆªåœ–

ä¸¦åœ¨æ–‡å­—ä¸­å¼·èª¿ï¼š
- webhook **X-Line-Signature**
- callback/webhook **idempotency**
- admin/public API boundary
- Cloudflare Pages SPA fallback + CORS/cookie ç­–ç•¥

---

## 14. æœ€å°å¯å•Ÿå‹•æ¸…å–®ï¼ˆä»Šå¤©å°±èƒ½é–‹å§‹åšï¼‰

1. Public ç«™å…ˆåšå‡º Projects list + detailï¼ˆmock dataï¼‰
2. Cloudflare Pages å…ˆéƒ¨ç½² â†’ å…ˆæœ‰ç¶²å€èƒ½å±•ç¤º
3. åŒæ­¥å»º MySQL schemaï¼ˆå« project_linksï¼‰
4. åš public list/detail APIï¼Œæ›¿æ› mock data
5. æœ€å¾Œå†åš adminã€LINE Botã€analyticsã€AI

---

## 15. ç•¶å‰å°ˆæ¡ˆç‹€æ…‹

> å‰ç«¯é–‹ç™¼é€²åº¦å·²ç§»è‡³ç¨ç«‹æ–‡ä»¶ï¼Œä»¥ä¾¿å‰å¾Œç«¯å”ä½œæºé€šã€‚

ðŸ“„ **è©³ç´°é€²åº¦è«‹è¦‹**ï¼š[å‰ç«¯é€²åº¦æ›¸.md](./å‰ç«¯é€²åº¦æ›¸.md)

### 15.1 å¿«é€Ÿæ¦‚è¦½

| é …ç›® | ç‹€æ…‹ |
|------|------|
| **å°ˆæ¡ˆ** | 71bk-landingï¼ˆPublic Portfolioï¼‰ |
| **éšŽæ®µ** | M1 åˆæœŸï¼ˆLanding Page é–‹ç™¼ä¸­ï¼‰ |
| **æŠ€è¡“æ£§** | Vue 3 + Vite + Tailwind CSS v4 |

### 15.2 é–‹ç™¼æŒ‡ä»¤

```bash
# å®‰è£ä¾è³´
npm install

# å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨
npm run dev

# å»ºç½®ç”Ÿç”¢ç‰ˆæœ¬
npm run build
```

---

## Appendix A â€” Mermaid Diagrams

### A.1 System Diagram
```mermaid
flowchart LR
  U[Browser] -->|HTTPS| CFP[Cloudflare Pages]
  U -->|HTTPS| API[api-profile.71bk.dev]
  API --> NX[Nginx on EC2]
  NX --> SB[Spring Boot]
  SB --> DB[(MySQL 8)]
  LINE[LINE Platform] -->|Webhook| API
  API -->|Reply/Push| LINE
```

### A.2 Admin Login Flow
```mermaid
sequenceDiagram
  participant U as Admin Console
  participant API as Backend API
  participant LINE as LINE Platform
  
  U->>API: GET /api/auth/line/login-url
  API-->>U: LINE Authorization URL
  U->>LINE: Redirect to LINE Login
  LINE-->>API: Callback with code
  API->>LINE: Exchange code for token
  LINE-->>API: Access token + Profile
  API-->>U: Set-Cookie (refresh_token) + Redirect
  U->>API: GET /api/auth/me
  API-->>U: User info + Access token
```

### A.3 LINE Webhook Flow
```mermaid
sequenceDiagram
  participant LINE as LINE Platform
  participant API as Backend API
  participant DB as MySQL
  
  LINE->>API: POST /api/line/webhook (X-Line-Signature)
  API->>API: Verify HMAC-SHA256
  API->>DB: Check event_id (idempotency)
  alt New Event
    API->>DB: Insert line_message_logs (INBOUND)
    API->>LINE: Reply message (optional)
    API->>DB: Insert line_message_logs (OUTBOUND)
  else Duplicate Event
    API-->>LINE: 200 OK (skip processing)
  end
```
